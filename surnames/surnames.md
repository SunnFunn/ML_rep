### **Генерация фамилий**

[Проект](https://github.com/SunnFunn/ML_rep/tree/master/surnames) выполнен как web-приложение с интерфейсом, позволяющим регистрировать данные нового пользователя, вводить пользователем первые буквы/букву (в разном количестве) фамилии, получать сгенерированные моделью образцы русских фамилий, а также сохранять в базе данных приложения историю запросов к модели;

> - Интерфейсы регистрации пользователя, ввода текста и получения оценки эмоциональной окраски представлены ниже на несколькихскриншотах.
> - На втором скриншоте можно ввести "температуру". Чем выше этот показатель (ближе к 1.0), тем более разнообразные и нестандартные фамилии может выдавать нейронная сеть.
> - Показатель температуры можно устанавливать и более 1.0, однако с такими высокими показателями нейронная сеть начинает выбирать варианты фамилий, слишком не похожие на русские классические фамилии.
> - На этой же странице интерфеса можно задать количество фамилий, которые нейросеть должна предложить, однако нейросеть может предложить меньшее количество, если сгенерированные варианты не удовлетворяют критериям отбора фамилий.
> - На последнем скриншоте демонстрируется возможность выбора статистики последних запросов по текущему пользователю.

![surnames_1](https://github.com/SunnFunn/ML_rep/blob/master/imgs/surnames_1.png)


![surnames_2](https://github.com/SunnFunn/ML_rep/blob/master/imgs/surnames_2.png)


![surnames_3](https://github.com/SunnFunn/ML_rep/blob/master/imgs/surnames_3.png)

![surnames_4](https://github.com/SunnFunn/ML_rep/blob/master/imgs/surnames_4.png)

Приложение развернуто на VM AWS в двух докер контейнерах : web-контейнер, контейнер flask-приложения с uWSGI сервером, с запуском контейнеров через конфигурацию в docker-compose.yml.
Контейнер flask-приложения создается по инструкциям Dockerfile с новым пользователем внутри контейнера и с передачей прав собственника всех файлов (рекурсивно) данному пользователю (в целях ухода от root собственника).
Конфигурация uWSGI представлена в фалйе surnames.ini и включает механизм гибкого изменения количества процессов сервера от 2 до 10 в зависимости от нагрузки. Статистика uWSGI сервера доступна на порте 9000.
Конфигурация nginx proxy server в целом стандартная.

Модель тренировалась отдельно (смотрите файл ./app/model/Conditioned_sequience.ipynb). Модель построена как реккурентная сеть с блоками GRU со следующими основными параметрами:

~~~

Количество слоев GRU: 2
Размерность пространста embbeding токенов: 128
Размерность пространста скрытого представления: 256

~~~
